<div class="security-container">  
  <!-- 悬浮控制层 -->
  <div class="control-layer">
    <!-- 创建任务按钮 -->
    <div class="floating-button">
      <n-button type="primary" size="medium" @click="showPatrolCreator = !showPatrolCreator">
        {{ showPatrolCreator ? '关闭创建' : '创建巡逻任务' }}
      </n-button>
    </div>

    <!-- 左侧任务创建面板 -->
    <div v-if="showPatrolCreator" class="left-panel">
      <div class="info-card">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-lg font-medium">创建巡逻任务</h3>
          <n-button quaternary circle size="small" @click="closePatrolCreator">
            <template #icon>
              <n-icon><close-icon /></n-icon>
            </template>
          </n-button>
        </div>
        <patrol-task-creator
          ref="patrolCreatorRef"
          :drones="availableDrones"
          @submit="handlePatrolTaskSubmit"
        />
      </div>
    </div>

    <!-- 右侧信息面板 -->
    <div class="side-panel">
      <!-- 巡逻任务列表 -->
      <patrol-task-list
        :tasks="tasks"
        :filter="taskFilter"
        :filter-options="filterOptions"
        @filter-change="handleFilterChange"
        @open-detail="openTaskDetail"
        @stop-task="stopTask"
      />

      <!-- 安全事件列表 -->
      <security-event-list
        :events="securityEvents"
        @view-all="viewAllEvents"
        @open-detail="openEventDetail"
        @focus-event="focusOnEvent"
      />
    </div>
  </div>

  <!-- 任务详情弹窗 -->
  <n-modal
    v-model:show="showTaskDetail"
    preset="card"
    style="max-width: 800px"
    :title="currentTask?.name"
    :mask-closable="true"
  >
    <patrol-task-detail
      v-if="currentTask"
      :task="currentTask"
      @close="closeTaskDetail"
      @stop-task="stopTask"
      @resume-task="resumeTask"
    />
  </n-modal>
</div>